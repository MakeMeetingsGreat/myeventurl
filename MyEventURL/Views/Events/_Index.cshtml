@Html.Partial("~/Views/Components/_GridComponent.cshtml")
@Html.Partial("~/Views/Components/_EventForm.cshtml")
@Html.Partial("~/Views/Components/_Admin.cshtml")

@{
    ViewBag.Title = "Index";
}

<button data-backdrop="static" data-toggle="modal" data-target="#eventform" style="position:absolute; min-width:200px; left:125px; height:50px">Create</button>
<h2>Index</h2>

<div id="eventlist">
  <adminmenu :future="future" :past="past"></adminmenu>
</div>

<script>
    var EventList = new Vue({
        el: '#eventlist',
        components: {
            'adminmenu': admincomponent
        },
        data: {
            future: [],
            past: [],
        },
        beforeCreate: function () {
            axios.get('/odata/GetEvent?$filter=Email eq \'' + Account.Email + '\'&$orderby=Start desc')
                .then(function (response) {
                    response.data.value.forEach(function (fact) {
                        var startmoment = moment(fact.Start);
                        var event = {
                            Start: startmoment.format("MMM D"),
                            Title: fact.Title,
                            Views: fact.Views,
                            Adds: fact.Engaged,
                            Actions: fact.EventId
                        }
                        var nowmoment = moment(Date.now());
                        if (nowmoment.diff(startmoment) < 0) EventList.future.push(event); else EventList.past.push(event)
                    })
                })
        },

        methods: {
        }
    })
</script>